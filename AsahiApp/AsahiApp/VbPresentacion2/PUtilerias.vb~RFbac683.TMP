Imports System.Windows.Forms

Public Class PUtilerias
    ''' <summary>
    ''' Herramienta para todos los combobox de un formulario,
    ''' se pueden limpiar solo algunos elementos o todo
    ''' </summary>
    ''' <param name="container"></param>
    ''' <param name="ds">DataSource</param>
    ''' <param name="vm">ValueMember</param>
    ''' <param name="dm">DisplayMember</param>
    ''' <param name="sv">SelectedValue</param>
    ''' <param name="si">SelectedItem</param>
    ''' <param name="tx">Text</param>
    Public Sub LimpiarComboBox(ByVal container As Control, ByVal ds As Boolean, ByVal vm As Boolean, ByVal dm As Boolean, ByVal sv As Boolean, ByVal si As Boolean, ByVal tx As Boolean)
        'Aborto procedimiento
        If container Is Nothing Then
            Return
        ElseIf Not container.HasChildren Then
            Return
        End If

        For Each ctrl As Control In container.Controls
            If TypeOf ctrl Is ComboBox Then
                If ds Then CType(ctrl, ComboBox).DataSource = Nothing
                If vm Then CType(ctrl, ComboBox).ValueMember = Nothing
                If dm Then CType(ctrl, ComboBox).DisplayMember = Nothing
                CType(ctrl, ComboBox).DropDownWidth = 1
                If sv Then CType(ctrl, ComboBox).SelectedValue = ""
                If si Then CType(ctrl, ComboBox).SelectedItem = Nothing
                If tx Then CType(ctrl, ComboBox).Text = Nothing
            End If

            'Si es un control contenedor
            If ctrl.HasChildren Then
                'Reinvoco procedimiento con este control
                LimpiarComboBox(ctrl, ds, vm, dm, sv, si, tx)
            End If
        Next
    End Sub
    Public Sub LimpiarTextBox(ByVal container As Control)
        'Aborto procedimiento
        If container Is Nothing Then
            Return
        ElseIf Not container.HasChildren Then
            Return
        End If

        For Each ctrl As Control In container.Controls
            If TypeOf ctrl Is TextBox Then
                CType(ctrl, TextBox).Clear()
            End If

            'Si es un control contenedor
            If ctrl.HasChildren Then
                'Reinvoco procedimiento con este control
                LimpiarTextBox(ctrl)
            End If
        Next
    End Sub
    ''' <summary>
    ''' Se agrega un Evento que involucra el cambio en todos los controles de un formulario
    ''' </summary>
    ''' <param name="container">contenedor con los controles correspondientes</param>
    Public Sub AgregarEventoCambiosFormulario(container As Control, Optional excepto As String = "")
        'Aborto procedimiento
        If container Is Nothing Then
            Return
        ElseIf Not container.HasChildren Then
            Return
        End If

        For Each ctrl As Control In container.Controls
            If TypeOf ctrl Is TextBox Then
                If ctrl.Name <> excepto Then
                    AddHandler ctrl.TextChanged, AddressOf FrmFactura.Cambios_Formulario
                End If
            End If

            'Si es un control contenedor
            If ctrl.HasChildren Then
                'Reinvoco procedimiento con este control
                AgregarEventoCambiosFormulario(ctrl)
            End If
        Next
    End Sub
    ''' <summary>
    ''' Habilitar todos los botones de un Formulario
    ''' </summary>
    ''' <param name="container"></param>
    Public Sub HabilitarBotones(ByVal container As Control)
        'Aborto procedimiento
        If container Is Nothing Then
            Return
        ElseIf Not container.HasChildren Then
            Return
        End If

        For Each ctrl As Control In container.Controls
            If TypeOf ctrl Is Button Then
                CType(ctrl, Button).Enabled = True
            End If

            'Si es un control contenedor
            If ctrl.HasChildren Then
                'Reinvoco procedimiento con este control
                LimpiarTextBox(ctrl)
            End If
        Next
    End Sub

End Class
